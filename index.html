<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hajj Passport Registration Form</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .logo {
            max-width: 150px;
            max-height: 80px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(255,255,255,0.2);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .form-container {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .bilingual-label {
            display: flex;
            flex-direction: column;
            margin-bottom: 8px;
        }

        .label-german {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95em;
            margin-bottom: 2px;
        }

        .label-arabic {
            font-weight: 500;
            color: #5a6c7d;
            font-size: 0.9em;
            direction: rtl;
            text-align: right;
            font-family: 'Arial', 'Tahoma', sans-serif;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="tel"]:focus,
        input[type="date"]:focus,
        select:focus {
            outline: none;
            border-color: #3498db;
            background: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        select {
            cursor: pointer;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .radio-item input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: #3498db;
        }

        .radio-item label {
            cursor: pointer;
            font-weight: 500;
            color: #2c3e50;
        }

        .file-upload {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            left: -9999px;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            border: 2px dashed #3498db;
            border-radius: 10px;
            background: #f8f9fa;
            transition: all 0.3s ease;
            min-height: 80px;
            text-align: center;
        }

        .file-upload-label:hover {
            border-color: #2980b9;
            background: #e3f2fd;
        }

        .file-upload-label.error {
            border-color: #e74c3c;
            background: #ffeaea;
        }

        .file-upload-label .upload-icon {
            font-size: 2em;
            margin-bottom: 10px;
            color: #3498db;
        }

        .file-upload-label .upload-text {
            color: #2c3e50;
            font-weight: 500;
        }

        .file-error {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }

        .file-info {
            color: #27ae60;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }

        .preview-container {
            margin-top: 15px;
            display: none;
        }

        .image-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-title {
            color: #2c3e50;
            font-size: 1.3em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            text-align: center;
        }

        .section-title-arabic {
            font-size: 1.1em;
            margin-top: 5px;
            color: #5a6c7d;
            direction: rtl;
            font-family: 'Arial', 'Tahoma', sans-serif;
        }

        .conditional-field {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #e74c3c;
        }

        .conditional-field.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .submit-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(52, 152, 219, 0.4);
        }

        .submit-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .required {
            color: #e74c3c;
        }

        .info-text {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 5px;
            font-style: italic;
        }

        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
            text-align: center;
        }

        .error-message {
            display: none;
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
            text-align: center;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .contact-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .contact-info strong {
            color: #2c3e50;
        }

        .phone-link {
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
        }

        .phone-link:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .container {
                margin: 10px;
            }

            .form-container {
                padding: 20px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div id="logoContainer">
            <img src="./logo.jpg" alt="Logo" class="logo" id="logoImage" onerror="this.style.display='none'">
        </div>

        <h1>Hajj Anmeldung<br><small style="font-size: 0.6em; opacity: 0.9;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¬</small></h1>
        <p>Bitte fÃ¼llen Sie alle Felder sorgfÃ¤ltig aus<br><small style="opacity: 0.8;">ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø¹Ù†Ø§ÙŠØ©</small></p>
    </div>

    <div class="form-container">
        <div class="success-message" id="successMessage">
            âœ… <strong>Erfolgreich versendet!</strong><br>
            <small style="opacity: 0.8;">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!</small><br><br>
            Ihre Hajj-Registrierung wurde erfolgreich Ã¼bermittelt. Wir werden uns in KÃ¼rze melden.<br>
            <small style="opacity: 0.8;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¬ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ø³ØªØªÙ„Ù‚Ù‰ ØªØ£ÙƒÙŠØ¯Ø§Ù‹ Ù‚Ø±ÙŠØ¨Ø§Ù‹.</small>
        </div>

        <div class="error-message" id="errorMessage">
            âŒ <strong>Fehler beim Senden</strong><br>
            <small style="opacity: 0.8;">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</small><br><br>
            Es gab einen technischen Fehler beim Ãœbermitteln Ihrer Daten.<br>
            <small style="opacity: 0.8;">Ø­Ø¯Ø« Ø®Ø·Ø£ ØªÙ‚Ù†ÙŠ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ.</small>
            <div class="contact-info">
                <strong>ğŸ“ Support kontaktieren:</strong><br>
                <small>Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¯Ø¹Ù…:</small><br>
                Telefon: <a href="tel:+491234567890" class="phone-link">+49 123 456 7890</a><br>
                E-Mail: <a href="mailto:support@hajj-services.de" class="phone-link">support@hajj-services.de</a><br>
                WhatsApp: <a href="https://wa.me/491234567890" class="phone-link" target="_blank">ğŸ“± WhatsApp</a>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Daten werden Ã¼bermittelt...<br><small>Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</small></p>
        </div>

        <form id="hajjForm" method="POST">
            <!-- Personal Information Section -->
            <div class="section-title">
                <div>PersÃ¶nliche Informationen</div>
                <div class="section-title-arabic">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Vorname <span class="required">*</span></div>
                        <div class="label-arabic">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</div>
                    </div>
                    <input type="text" id="vorname" name="vorname" placeholder="Vorname / Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„" required>
                </div>
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Nachname <span class="required">*</span></div>
                        <div class="label-arabic">Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</div>
                    </div>
                    <input type="text" id="nachname" name="nachname" placeholder="Nachname / Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">E-Mail Adresse <span class="required">*</span></div>
                        <div class="label-arabic">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                    </div>
                    <input type="email" id="email" name="email" placeholder="email@example.com" required>
                </div>
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Telefonnummer (WhatsApp) <span class="required">*</span></div>
                        <div class="label-arabic">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (ÙˆØ§ØªØ³Ø§Ø¨)</div>
                    </div>
                    <input type="tel" id="telefon" name="telefon" placeholder="+49 123 456789" required>
                    <div class="info-text">Bitte WhatsApp-fÃ¤hige Nummer angeben / ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨</div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Geburtsdatum <span class="required">*</span></div>
                        <div class="label-arabic">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</div>
                    </div>
                    <input type="date" id="geburtsdatum" name="geburtsdatum" required>
                </div>
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">NationalitÃ¤t <span class="required">*</span></div>
                        <div class="label-arabic">Ø§Ù„Ø¬Ù†Ø³ÙŠØ©</div>
                    </div>
                    <select id="nationalitaet" name="nationalitaet" required>
                        <option value="">NationalitÃ¤t wÃ¤hlen / Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©</option>
                        <optgroup label="Europa / Ø£ÙˆØ±ÙˆØ¨Ø§">
                            <option value="deutsch">Deutsch / Ø£Ù„Ù…Ø§Ù†ÙŠ</option>
                            <option value="oesterreichisch">Ã–sterreichisch / Ù†Ù…Ø³Ø§ÙˆÙŠ</option>
                            <option value="schweiz">Schweizer / Ø³ÙˆÙŠØ³Ø±ÙŠ</option>
                            <option value="niederlaendisch">NiederlÃ¤ndisch / Ù‡ÙˆÙ„Ù†Ø¯ÙŠ</option>
                            <option value="belgisch">Belgisch / Ø¨Ù„Ø¬ÙŠÙƒÙŠ</option>
                            <option value="franzoesisch">FranzÃ¶sisch / ÙØ±Ù†Ø³ÙŠ</option>
                            <option value="italienisch">Italienisch / Ø¥ÙŠØ·Ø§Ù„ÙŠ</option>
                            <option value="spanisch">Spanisch / Ø¥Ø³Ø¨Ø§Ù†ÙŠ</option>
                            <option value="britisch">Britisch / Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ</option>
                            <option value="tuerkisch">TÃ¼rkisch / ØªØ±ÙƒÙŠ</option>
                            <option value="syrisch">Syrisch / Ø³ÙˆØ±ÙŠ</option>
                            <option value="irakisch">Irakisch / Ø¹Ø±Ø§Ù‚ÙŠ</option>
                            <option value="afghanisch">Afghanisch / Ø£ÙØºØ§Ù†ÙŠ</option>
                            <option value="marokkanisch">Marokkanisch / Ù…ØºØ±Ø¨ÙŠ</option>
                            <option value="tunesisch">Tunesisch / ØªÙˆÙ†Ø³ÙŠ</option>
                            <option value="aegyptisch">Ã„gyptisch / Ù…ØµØ±ÙŠ</option>
                            <option value="libanesisch">Libanesisch / Ù„Ø¨Ù†Ø§Ù†ÙŠ</option>
                            <option value="jordanisch">Jordanisch / Ø£Ø±Ø¯Ù†ÙŠ</option>
                            <option value="palaestinensisch">PalÃ¤stinensisch / ÙÙ„Ø³Ø·ÙŠÙ†ÙŠ</option>
                            <option value="pakistanisch">Pakistanisch / Ø¨Ø§ÙƒØ³ØªØ§Ù†ÙŠ</option>
                            <option value="indisch">Indisch / Ù‡Ù†Ø¯ÙŠ</option>
                            <option value="bangladeschisch">Bangladeschisch / Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´ÙŠ</option>
                            <option value="sonstige">Sonstige / Ø£Ø®Ø±Ù‰</option>
                        </optgroup>
                    </select>
                </div>
            </div>

            <!-- Passport Information Section -->
            <div class="section-title">
                <div>Reisepass Informationen</div>
                <div class="section-title-arabic">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</div>
            </div>

            <div class="form-group">
                <div class="bilingual-label">
                    <div class="label-german">Art des Reisepasses <span class="required">*</span></div>
                    <div class="label-arabic">Ù†ÙˆØ¹ Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</div>
                </div>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="pass_europaeisch" name="passart" value="europaeisch" required>
                        <label for="pass_europaeisch">EuropÃ¤ischer Pass<br><small>Ø§Ù„Ø¬ÙˆØ§Ø² Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ</small></label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="pass_blau" name="passart" value="blau" required>
                        <label for="pass_blau">Blauer Reiseausweis<br><small>ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø³ÙØ± Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡</small></label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="pass_auslaendisch" name="passart" value="auslaendisch" required>
                        <label for="pass_auslaendisch">AuslÃ¤ndischer Pass mit Aufenthaltstitel<br><small>Ø¬ÙˆØ§Ø² Ø³ÙØ± Ø£Ø¬Ù†Ø¨ÙŠ Ù…Ø¹ Ø¥Ù‚Ø§Ù…Ø©</small></label>
                    </div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Passnummer <span class="required">*</span></div>
                        <div class="label-arabic">Ø±Ù‚Ù… Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</div>
                    </div>
                    <input type="text" id="passnummer" name="passnummer" placeholder="Passnummer / Ø±Ù‚Ù… Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±" required>
                </div>
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Pass GÃ¼ltigkeit <span class="required">*</span></div>
                        <div class="label-arabic">ØµÙ„Ø§Ø­ÙŠØ© Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</div>
                    </div>
                    <input type="date" id="passgueltigkeit" name="passgueltigkeit" required>
                    <div class="info-text">Muss mindestens 6 Monate gÃ¼ltig sein / ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ØµØ§Ù„Ø­Ø§Ù‹ Ù„Ù…Ø¯Ø© 6 Ø£Ø´Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</div>
                </div>
            </div>

            <!-- Conditional Aufenthaltstitel Field -->
            <div id="aufenthaltstitelSection" class="conditional-field">
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Aufenthaltstitel hochladen <span class="required">*</span></div>
                        <div class="label-arabic">ØªØ­Ù…ÙŠÙ„ ØªØµØ±ÙŠØ­ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©</div>
                    </div>
                    <div class="file-upload">
                        <input type="file" id="aufenthaltstitel-image" name="aufenthaltstitel-image" accept="image/*,application/pdf">
                        <label for="aufenthaltstitel-image" class="file-upload-label">
                            <div>
                                <div class="upload-icon">ğŸ“„</div>
                                <div class="upload-text">Aufenthaltstitel hochladen<br><small style="color: #7f8c8d;">ØªØ­Ù…ÙŠÙ„ ØªØµØ±ÙŠØ­ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©</small></div>
                                <small>JPG, PNG, PDF â€¢ Max. 10MB<br>Ø§Ù„ÙˆØ¬Ù‡ÙŠÙ† Ù…Ø·Ù„ÙˆØ¨Ø§Ù† â€¢ Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</small>
                            </div>
                        </label>
                    </div>
                    <div class="file-error" id="aufenthaltstitel-error"></div>
                    <div class="file-info" id="aufenthaltstitel-info"></div>
                    <div class="preview-container" id="aufenthaltstitel-preview">
                        <img class="image-preview" id="aufenthaltstitel-img">
                        <div class="pdf-preview" id="aufenthaltstitel-pdf" style="display: none;">
                            <div style="background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 10px; padding: 20px; text-align: center;">
                                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“„</div>
                                <div style="font-weight: 600; color: #2c3e50;">PDF Dokument</div>
                                <div style="color: #7f8c8d; margin-top: 5px;" id="aufenthaltstitel-pdf-name"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Document Upload Section -->
            <div class="section-title">
                <div>Dokumente hochladen</div>
                <div class="section-title-arabic">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚</div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Reisepass Kopie <span class="required">*</span></div>
                        <div class="label-arabic">Ù†Ø³Ø®Ø© Ù…Ù† Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</div>
                    </div>
                    <div class="file-upload">
                        <input type="file" id="passport-copy" name="passport-copy" accept="image/*,application/pdf" required>
                        <label for="passport-copy" class="file-upload-label">
                            <div>
                                <div class="upload-icon">ğŸ“‹</div>
                                <div class="upload-text">Reisepass Kopie<br><small style="color: #7f8c8d;">Ù†Ø³Ø®Ø© Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±</small></div>
                                <small>JPG, PNG, PDF â€¢ Max. 10MB<br>Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª Ø°Ø§Øª Ø§Ù„ØµÙ„Ø© â€¢ Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</small>
                            </div>
                        </label>
                    </div>
                    <div class="file-error" id="passport-copy-error"></div>
                    <div class="file-info" id="passport-copy-info"></div>
                    <div class="preview-container" id="passport-copy-preview">
                        <img class="image-preview" id="passport-copy-img">
                        <div class="pdf-preview" id="passport-copy-pdf" style="display: none;">
                            <div style="background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 10px; padding: 20px; text-align: center;">
                                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“„</div>
                                <div style="font-weight: 600; color: #2c3e50;">PDF Dokument</div>
                                <div style="color: #7f8c8d; margin-top: 5px;" id="passport-copy-pdf-name"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="bilingual-label">
                        <div class="label-german">Biometrisches Passbild <span class="required">*</span></div>
                        <div class="label-arabic">ØµÙˆØ±Ø© Ø¬ÙˆØ§Ø² Ø³ÙØ± Ø¨ÙŠÙˆÙ…ØªØ±ÙŠØ©</div>
                    </div>
                    <div class="file-upload">
                        <input type="file" id="passport-photo" name="passport-photo" accept="image/*,application/pdf" required>
                        <label for="passport-photo" class="file-upload-label">
                            <div>
                                <div class="upload-icon">ğŸ“·</div>
                                <div class="upload-text">Biometrisches Passbild<br><small style="color: #7f8c8d;">ØµÙˆØ±Ø© Ø¨ÙŠÙˆÙ…ØªØ±ÙŠØ©</small></div>
                                <small>JPG, PNG, PDF â€¢ Max. 10MB<br>Ø®Ù„ÙÙŠØ© Ø¨ÙŠØ¶Ø§Ø¡ØŒ 35x45 Ù…Ù„Ù… â€¢ Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</small>
                            </div>
                        </label>
                    </div>
                    <div class="file-error" id="passport-photo-error"></div>
                    <div class="file-info" id="passport-photo-info"></div>
                    <div class="preview-container" id="passport-photo-preview">
                        <img class="image-preview" id="passport-photo-img">
                        <div class="pdf-preview" id="passport-photo-pdf" style="display: none;">
                            <div style="background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 10px; padding: 20px; text-align: center;">
                                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ“„</div>
                                <div style="font-weight: 600; color: #2c3e50;">PDF Dokument</div>
                                <div style="color: #7f8c8d; margin-top: 5px;" id="passport-photo-pdf-name"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Nusuk Registration Section -->
            <div class="section-title">
                <div>ğŸ“± Nusuk Registration</div>
                <div class="section-title-arabic">ØªØ³Ø¬ÙŠÙ„ Ù†Ø³Ùƒ</div>
            </div>

            <div class="form-group">
                <div class="bilingual-label">
                    <div class="label-german">Haben Sie sich bereits auf Nusuk registriert? <span class="required">*</span></div>
                    <div class="label-arabic">Ù‡Ù„ Ù‚Ù…Øª Ø¨Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¹Ù„Ù‰ Ù†Ø³Ùƒ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ</div>
                </div>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="nusuk_ja" name="nusuk_registriert" value="ja" required>
                        <label for="nusuk_ja">Ja / Ù†Ø¹Ù…</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="nusuk_nein" name="nusuk_registriert" value="nein" required>
                        <label for="nusuk_nein">Nein / Ù„Ø§</label>
                    </div>
                </div>
                <div class="info-text">
                    Nusuk ist die offizielle Saudi-Arabische Plattform fÃ¼r Hajj und Umrah Registrierungen<br>
                    <small>Ù†Ø³Ùƒ Ù‡Ùˆ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„ØªØ³Ø¬ÙŠÙ„Ø§Øª Ø§Ù„Ø­Ø¬ ÙˆØ§Ù„Ø¹Ù…Ø±Ø©</small>
                </div>
            </div>

            <button type="button" class="submit-btn" id="submitButton">
                Hajj-Anmeldung absenden<br><small style="font-size: 0.8em; opacity: 0.9;">Ø¥Ø±Ø³Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¬</small>
            </button>
        </form>
    </div>
</div>

<script>
    // Document ready handler
    document.addEventListener('DOMContentLoaded', function() {
        setupEventListeners();
    });

    function setupEventListeners() {
        // Submit button click handler
        const submitButton = document.getElementById('submitButton');
        if (submitButton) {
            submitButton.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                handleFormSubmission();
            });
        }

        // Form submit handler (backup)
        const form = document.getElementById('hajjForm');
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                e.stopPropagation();
                handleFormSubmission();
                return false;
            });
        }

        // Conditional Aufenthaltstitel field
        const passartRadios = document.querySelectorAll('input[name="passart"]');
        passartRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                const aufenthaltstitelSection = document.getElementById('aufenthaltstitelSection');
                const aufenthaltstitelInput = document.getElementById('aufenthaltstitel-image');

                if (this.value === 'auslaendisch') {
                    aufenthaltstitelSection.classList.add('show');
                    aufenthaltstitelInput.required = true;
                } else {
                    aufenthaltstitelSection.classList.remove('show');
                    aufenthaltstitelInput.required = false;
                }
            });
        });

        // File upload handlers
        setupFileUpload('passport-copy');
        setupFileUpload('passport-photo');
        setupFileUpload('aufenthaltstitel-image');
    }

    function setupFileUpload(inputId) {
        const input = document.getElementById(inputId);
        if (input) {
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    validateFile(file, input, inputId + '-error', inputId + '-info');

                    // Show preview for images
                    if (file.type.startsWith('image/')) {
                        const preview = document.getElementById(inputId + '-preview');
                        const img = document.getElementById(inputId + '-img');
                        if (preview && img) {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                img.src = e.target.result;
                                preview.style.display = 'block';
                            };
                            reader.readAsDataURL(file);
                        }
                    } else if (file.type === 'application/pdf') {
                        const preview = document.getElementById(inputId + '-preview');
                        const pdfPreview = document.getElementById(inputId + '-pdf');
                        const pdfName = document.getElementById(inputId + '-pdf-name');
                        if (preview && pdfPreview && pdfName) {
                            pdfName.textContent = file.name;
                            pdfPreview.style.display = 'block';
                            preview.style.display = 'block';
                        }
                    }
                }
            });
        }
    }

    // File validation function
    function validateFile(file, inputElement, errorElementId, infoElementId) {
        const maxSize = 10 * 1024 * 1024; // 10MB in bytes
        const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'application/pdf'];
        const errorElement = document.getElementById(errorElementId);
        const infoElement = document.getElementById(infoElementId);
        const label = inputElement.parentElement.querySelector('.file-upload-label');

        // Reset previous states
        if (errorElement) errorElement.style.display = 'none';
        if (infoElement) infoElement.style.display = 'none';
        if (label) label.classList.remove('error');

        // Check file type
        if (!allowedTypes.includes(file.type)) {
            if (errorElement) {
                errorElement.innerHTML = `
                    âŒ UngÃ¼ltiger Dateityp: ${file.type}<br>
                    Erlaubt: JPG, PNG, GIF, WebP, PDF<br>
                    <small>Ù†ÙˆØ¹ Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­. Ø§Ù„Ù…Ø³Ù…ÙˆØ­: JPG, PNG, GIF, WebP, PDF</small>
                `;
                errorElement.style.display = 'block';
            }
            if (label) label.classList.add('error');
            inputElement.value = '';
            return false;
        }

        // Check file size
        if (file.size > maxSize) {
            const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
            if (errorElement) {
                errorElement.innerHTML = `
                    âŒ Datei zu groÃŸ: ${sizeMB}MB (Max: 10MB)<br>
                    <small>Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹: ${sizeMB} Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª)</small>
                `;
                errorElement.style.display = 'block';
            }
            if (label) label.classList.add('error');
            inputElement.value = '';
            return false;
        }

        // File is valid
        const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
        const fileTypeText = file.type === 'application/pdf' ? 'PDF' : 'Bild';
        const fileTypeArabic = file.type === 'application/pdf' ? 'PDF' : 'ØµÙˆØ±Ø©';
        if (infoElement) {
            infoElement.innerHTML = `
                âœ… ${fileTypeText} akzeptiert: ${file.name} (${sizeMB}MB)<br>
                <small>ØªÙ… Ù‚Ø¨ÙˆÙ„ ${fileTypeArabic}: ${file.name} (${sizeMB} Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª)</small>
            `;
            infoElement.style.display = 'block';
        }
        return true;
    }

    // Main form submission handler
    function handleFormSubmission() {
        const form = document.getElementById('hajjForm');
        const submitBtn = document.getElementById('submitButton');
        const loading = document.getElementById('loading');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        // Prevent double submission
        if (submitBtn.disabled) {
            return;
        }

        // Basic form validation
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        // Check required files
        const requiredFiles = ['passport-copy', 'passport-photo'];
        const passart = document.querySelector('input[name="passart"]:checked')?.value;

        if (passart === 'auslaendisch') {
            requiredFiles.push('aufenthaltstitel-image');
        }

        for (const fileId of requiredFiles) {
            const fileInput = document.getElementById(fileId);
            if (!fileInput || !fileInput.files || fileInput.files.length === 0) {
                alert(`Bitte laden Sie eine Datei fÃ¼r ${fileId} hoch`);
                return;
            }
        }

        // Final file validation
        const fileInputs = ['passport-copy', 'passport-photo', 'aufenthaltstitel-image'];
        const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'application/pdf'];
        let hasInvalidFiles = false;

        fileInputs.forEach(inputId => {
            const input = document.getElementById(inputId);
            if (input && input.files && input.files.length > 0) {
                const file = input.files[0];

                if (!allowedTypes.includes(file.type)) {
                    hasInvalidFiles = true;
                    alert(`âŒ UngÃ¼ltiger Dateityp: ${file.name}\nErlaubt: JPG, PNG, GIF, WebP, PDF`);
                    return;
                }

                if (file.size > 10 * 1024 * 1024) {
                    hasInvalidFiles = true;
                    const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
                    alert(`âŒ Fehler: ${file.name} ist ${sizeMB}MB groÃŸ (Max: 10MB)`);
                }
            }
        });

        if (hasInvalidFiles) {
            return;
        }

        // Disable submit button and show loading
        submitBtn.disabled = true;
        submitBtn.innerHTML = 'â³ Wird gesendet...<br><small style="font-size: 0.8em; opacity: 0.9;">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...</small>';

        // Hide previous messages
        successMessage.style.display = 'none';
        errorMessage.style.display = 'none';
        loading.style.display = 'block';

        // Create FormData
        const formData = new FormData(form);

        // Remove aufenthaltstitel if not needed
        if (passart !== 'auslaendisch') {
            formData.delete('aufenthaltstitel-image');
        }

        // Submit to server
        fetch('/.netlify/functions/submit-hajj-registration', {
            method: 'POST',
            body: formData
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Server Error ${response.status}: ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                loading.style.display = 'none';

                if (data.success) {
                    successMessage.innerHTML = `
                    âœ… <strong>Erfolgreich versendet!</strong><br>
                    <small style="opacity: 0.8;">ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!</small><br><br>
                    Ihre Hajj-Registrierung wurde erfolgreich Ã¼bermittelt (ID: ${data.id}).<br>
                    Sie erhalten in KÃ¼rze eine BestÃ¤tigung per E-Mail und WhatsApp.<br>
                    <small style="opacity: 0.8;">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¬ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ø³ØªØªÙ„Ù‚Ù‰ ØªØ£ÙƒÙŠØ¯Ø§Ù‹ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙˆØ§ØªØ³Ø§Ø¨.</small>
                `;
                    successMessage.style.display = 'block';

                    // Reset form and previews
                    form.reset();
                    document.querySelectorAll('.preview-container').forEach(preview => {
                        preview.style.display = 'none';
                    });
                    document.querySelectorAll('.file-info').forEach(info => {
                        info.style.display = 'none';
                    });
                    document.getElementById('aufenthaltstitelSection').classList.remove('show');

                    // Reset button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'ğŸ“¤ Hajj-Anmeldung absenden<br><small style="font-size: 0.8em; opacity: 0.9;">Ø¥Ø±Ø³Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¬</small>';

                    // Scroll to success message
                    successMessage.scrollIntoView({ behavior: 'smooth' });

                } else {
                    throw new Error(data.error || 'Unbekannter Server-Fehler');
                }
            })
            .catch(error => {
                loading.style.display = 'none';
                console.error('Submit Error:', error);

                let errorDetails = '';
                if (error.message.includes('NetworkError') || error.message.includes('Failed to fetch')) {
                    errorDetails = 'Netzwerkfehler - Bitte Ã¼berprÃ¼fen Sie Ihre Internetverbindung.';
                } else if (error.message.includes('Server Error')) {
                    errorDetails = 'Server-Fehler - Bitte versuchen Sie es spÃ¤ter erneut.';
                } else {
                    errorDetails = error.message;
                }

                errorMessage.innerHTML = `
                âŒ <strong>Fehler beim Senden</strong><br>
                <small style="opacity: 0.8;">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</small><br><br>
                <strong>Fehlerdetails:</strong> ${errorDetails}<br><br>
                Bitte versuchen Sie es erneut oder kontaktieren Sie uns fÃ¼r Hilfe.<br>
                <small style="opacity: 0.8;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø£Ùˆ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©.</small>
                <div class="contact-info">
                    <strong>ğŸ“ Support kontaktieren:</strong><br>
                    <small>Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¯Ø¹Ù…:</small><br>
                    Telefon: <a href="tel:+491234567890" class="phone-link">+49 123 456 7890</a><br>
                    E-Mail: <a href="mailto:support@hajj-services.de" class="phone-link">support@hajj-services.de</a><br>
                    WhatsApp: <a href="https://wa.me/491234567890?text=Hilfe%20bei%20Hajj%20Registration" class="phone-link" target="_blank">ğŸ“± WhatsApp Support</a>
                </div>
            `;
                errorMessage.style.display = 'block';

                // Re-enable button after error
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'ğŸ”„ Erneut versuchen<br><small style="font-size: 0.8em; opacity: 0.9;">Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</small>';

                // Scroll to error message
                errorMessage.scrollIntoView({ behavior: 'smooth' });
            });
    }

    // Phone number formatting
    document.addEventListener('input', function(e) {
        if (e.target && e.target.id === 'telefon') {
            let value = e.target.value.replace(/\D/g, '');
            if (value.startsWith('49')) {
                value = '+' + value;
            } else if (value.startsWith('0')) {
                value = '+49' + value.substring(1);
            }
            e.target.value = value;
        }
    });

    // Passport number formatting (uppercase)
    document.addEventListener('input', function(e) {
        if (e.target && e.target.id === 'passnummer') {
            e.target.value = e.target.value.toUpperCase();
        }
    });

    // Email validation
    document.addEventListener('blur', function(e) {
        if (e.target && e.target.id === 'email') {
            const email = e.target.value;
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (email && !emailPattern.test(email)) {
                e.target.setCustomValidity('Bitte geben Sie eine gÃ¼ltige E-Mail Adresse ein');
            } else {
                e.target.setCustomValidity('');
            }
        }
    }, true);

    // Passport validity check (must be at least 6 months in future)
    document.addEventListener('change', function(e) {
        if (e.target && e.target.id === 'passgueltigkeit') {
            const selectedDate = new Date(e.target.value);
            const sixMonthsFromNow = new Date();
            sixMonthsFromNow.setMonth(sixMonthsFromNow.getMonth() + 6);

            if (selectedDate < sixMonthsFromNow) {
                alert('âš ï¸ Warnung: Ihr Pass lÃ¤uft in weniger als 6 Monaten ab. Dies kÃ¶nnte zu Problemen fÃ¼hren.\n\nØªØ­Ø°ÙŠØ±: ÙŠÙ†ØªÙ‡ÙŠ Ø¬ÙˆØ§Ø²Ùƒ Ø®Ù„Ø§Ù„ Ø£Ù‚Ù„ Ù…Ù† 6 Ø£Ø´Ù‡Ø±. Ù‚Ø¯ ÙŠØ¤Ø¯ÙŠ Ù‡Ø°Ø§ Ø¥Ù„Ù‰ Ù…Ø´Ø§ÙƒÙ„.');
            }
        }
    });

    // Age validation (must be at least 18 years old)
    document.addEventListener('change', function(e) {
        if (e.target && e.target.id === 'geburtsdatum') {
            const birthDate = new Date(e.target.value);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();

            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }

            if (age < 18) {
                alert('âš ï¸ Sie mÃ¼ssen mindestens 18 Jahre alt sein.\n\nØªØ­Ø°ÙŠØ±: ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¹Ù…Ø±Ùƒ 18 Ø³Ù†Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.');
            }
        }
    });
</script>
</body>
</html>